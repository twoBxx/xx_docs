# 正则表达式

[**正则表达式在线测试地址**](https://regex101.com/)

## 1.元字符

| **元字符** | **描述**                                                     |
| :--------: | ------------------------------------------------------------ |
|     .      | 句号匹配任意单个字符除了换行符.                              |
|    [ ]     | 字符种类，匹配方括号内的任意字符                             |
|    [^ ]    | 否定的字符种类，匹配除了方括号离的任意字符                   |
|     *      | 匹配 >= 0 个重复的在*号之前的字符                            |
|     +      | 匹配 >1 个重复的+号之前的字符                                |
|     ?      | 标记?之前的字符为可选                                        |
|   {n,m}    | 匹配num个中括号之前的字符（n<= num <= m）                    |
|   (xyz)    | 字符集，匹配xyz完全相等的字符串                              |
|     \|     | 或运算符，匹配符合前或者后的字符                             |
|     \      | 转义字符，用于匹配一些保留字符  比如： [  ]  (  )  {  }  . *  + ? ^ $ \ \| |
|     ^      | 从开始匹配                                                   |
|     $      | 从末端开始匹配                                               |

### 1.1 点运算符

`.ar`  匹配一个任意字符后面跟着是`a`和`r`的字符

> ".ar" => The c**ar** p**ar**ked in the g**ar**age.

### 1.2字符集

`[Tt]he` 匹配 `The` 和 `the` 字符

`ar[.] ` 匹配 `ar.` 字符

#### 1.2.1 否定字符集

`[^c]ar` 表示匹配一个后面跟着`ar`的 除了`c` 的任意字符

> " [ ^c ]ar" => The car **par**ked in the **gar**age

### 1.3 重复次数

后面跟着元字符 `+`, `*` 或者 `?` 的, 用来指定匹配子模式的次数. 这些元字符在不同的情况下有着不同的意思.

#### 1.3.1 `*`号

`*` 号匹配在 `*`号之前的字符出现次数 `大于等于0次`。ex: `a*` 匹配以0个或者更多a开头的字符，相当于是匹配所有字符

#### 1.3.2 `+` 号

`+`号匹配 `+`号之前的字符出现 >=1次个字符  ex: `c.+t` 匹配以首字母 `c` 开头，以 `t`结尾，中间跟着任意个字符的字符串

##### 1.3.3 `?` 号

 `?` 标记在符号前面的字符为可选, 即出现 0 或 1 次. ex： 表达式 `[T]?he` 匹配字符串 `he` 和 `The`

> "[T]?he" => T**he** car is parked in **the** garage. 

### 1.4 `{}` 号

`{}` 是一个量词, 常用来一个或一组字符可以重复出现的次数. ex： 表达式 `[0-9]{2,3}` 匹配 2~3 位 0~9 的数字

我们可以省略第二个参数. ex： `[0-9]{2,}` 匹配至少两位 0~9 的数字

如果逗号也省略掉则表示重复固定的次数. ex： `[0-9]{3}` 匹配3位数字

### 1.5 `(...)` 特征标群

特征标群是一组写在 `(...)` 中的子模式

如果在 `{}` 前加入特征标群则表示整个标群内的字符重复 N 次. ex： 表达式 `(ab)*` 匹配连续出现 0 或更多个 `ab` 

我们还可以在 `()` 中用或字符 `|` 表示或. ex： `(c|g|p)ar` 匹配 `car` 或 `gar` 或 `par` 

### 1.6 `|` 运算符

表示 或 ，用作判断条件

### 1.7 转码特殊字符

反斜线 `\` 在表达式中用于转码紧跟其后的字符，用于指定 `{ } [ ] / \ + * . $ ^ | ?`  这些字符

### 1.8 锚点

想要匹配指定开头或结尾的字符就要使用到锚点。`^` 指定开头，`$` 指定结尾

#### 1.8.1 `^`号

`^` 用来检查匹配的字符串是否在所匹配字符串的开头。

> ex：^a ,匹配所有a开头的字符串

#### 1.8.2 `$`号

`^` 用于匹配字符是否是最后一个。

> ex: (at \ .)$  匹配是否以 `at.` 结尾的字符串



## 2 简写字符集

正则表达式提供一些常用的字符集简写. 如下:

|简写|描述|
|:----:|----|
|.|除换行符外的所有字符|
|\w|匹配所有字母数字, 等同于 `[a-zA-Z0-9_]`|
|\W|匹配所有非字母数字, 即符号, 等同于: `[^\w]`|
|\d|匹配数字: `[0-9]`|
|\D|匹配非数字: `[^\d]`|
|\s|匹配所有空格字符, 等同于: `[\t\n\f\r\p{Z}]`|
|\S|匹配所有非空格字符: `[^\s]`|
|\f|匹配一个换页符|
|\n|匹配一个换行符|
|\r|匹配一个回车符|
|\t|匹配一个制表符|
|\v|匹配一个垂直制表符|
|\p|匹配 CR/LF (等同于 `\r\n`)，用来匹配 DOS 行终止符|



## 3 零宽度断言（前后预查）

先行断言和后发断言都属于**非捕获簇**(不捕获文本 ，也不针对组合计进行计数). 先行断言用于判断所匹配的格式是否在另一个确定的格式之前, 匹配结果不包含该确定格式(仅作为约束)。

符号描述：

| 符号 | 描述                  |
| :--: | --------------------- |
|  ?=  | 正先行断言  ---> 存在 |
|  ?!  | 负先行断言  ---> 排除 |
| ?<=  | 正后发断言  ---> 存在 |
| ?<!  | 负后发断言  ---> 排除 |

```
(?<=\$)[0-9\.]* 匹配表达式 $ 开头，之后跟着数字 0-9 和 . 字符 这些字符可以出现大于等于0次
```

### 3.1 `?=...` 正先行断言

`?=...` 正先行断言, 表示第一部分表达式之后必须跟着 `?=...`定义的表达式

正先行断言的内容写在括号中的等号后面. ex： 表达式 `(T|t)he(?=\sfat)` 匹配 `The` 和 `the`, 在括号中我们又定义了正先行断言 `(?=\sfat)` ,即 `The` 和 `the` 后面紧跟着 `(空格)fat`

> "(T|t)he(?=\sfat)" => **The** fat cat sat on the mat.



### 3.2 `?!...` 负先行断言

用于筛选所有匹配结果, 筛选条件为 其后不跟随着断言中定义的格式

表达式 `(T|t)he(?!\sfat)` 匹配 `The` 和 `the`, 且其后不跟着 `(空格)fat`

> "(T|t)he(?=\sfat)" => The fat cat sat on **the** mat.



### 3.3 `?<=...` 正后发断言

正后发断言 记作`(?<=...)` 用于筛选所有匹配结果, 筛选条件为 其前跟随着断言中定义的格式. ex： 表达式 `(?<=(T|t)he\s)(fat|mat)` 匹配 `fat` 和 `mat`, 且其前跟着 `The` 或 `the` 


> "(?<=(T|t)he\s)(fat|mat)" => The **fat** cat sat on the **mat**.



### 3.4 `?<!...` 负后发断言



## 4.标志

| 标志 | 描述                                             |
| :--: | ------------------------------------------------ |
|  i   | 忽略大小写                                       |
|  g   | 全局搜索                                         |
|  m   | 多行的: 锚点元字符 `^` `$` 工作范围在每行的起始. |

### 4.1 忽略大小写

修饰语 `i` 用于忽略大小写. ex： 表达式 `/The/gi` 表示在全局搜索 `The`, 在后面的 `i` 将其条件修改为忽略大小写, 则变成搜索 `the` 和 `The`, `g` 表示全局搜索

> "The" => **The** fat cat sat on the mat.
> "/The/gi" => **The** fat cat sat on **the** mat.



### 4.2 全局搜索

修饰符 `g` 常用于执行一个全局搜索匹配, 即(不仅仅返回第一个匹配的, 而是返回全部). ex： 表达式 `/.(at)/g` 表示搜索 任意字符(除了换行) + `at`, 并返回全部结果

> "/.(at)/" => The **fat** cat sat on the mat.
> "/.(at)/g" => The **fat** **cat** **sat** on the **mat**.



### 4.3 多行修饰符

多行修饰符 `m` 用于执行一个多行匹配。ex： 表达式 `/at(.)?$/gm` 表示小写字符 `a` 后跟小写字符 `t` , 末尾可选除换行符外任意字符. 根据 `m` 修饰符, 现在表达式匹配每行的结尾

> "/.at(.)?$/" => The fat
                        cat sat
                        on the **mat.**

> "/.at(.)?$/gm" => The **fat**
                              cat **sat**
                              on the **mat.**



## 5. 贪婪匹配与惰性匹配

正则表达式默认使用贪婪匹配模式，在该模式下意味着会尽量匹配最长的字串。可以使用 `?` 将贪婪匹配模式转换为惰性匹配模式

> "/(.*at)/" => **The fat cat sat on the mat**.     贪婪匹配
> "/(.*?at)/" => **The fat** cat sat on the mat.    惰性匹配



## 6. 常用正则

- *正整数*: `^\d+$`
- *负整数*: `^-\d+$`
- *手机国家号*: `^+?[\d\s]{3,}$`
- *手机号*: `^+?[\d\s]+(?[\d\s]{10,}$`
- *整数*: `^-?\d+$`
- *用户名*: `^[\w\d_.]{4,16}$`
- *数字和英文字母*: `^[a-zA-Z0-9]*$`
- *数字和应为字母和空格*: `^[a-zA-Z0-9 ]*$`
- *密码*: `^(?=^.{6,}$)((?=.*[A-Za-z0-9])(?=.*[A-Z])(?=.*[a-z]))^.*$`
- *邮箱*: `^([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4})*$`
- *IP4 地址*: `^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$`
- *纯小写字母*: `^([a-z])*$`
- *纯大写字母*: `^([A-Z])*$`
- *URL*: `^(((http|https|ftp):\/\/)?([[a-zA-Z0-9]\-\.])+(\.)([[a-zA-Z0-9]]){2,4}([[a-zA-Z0-9]\/+=%&_\.~?\-]*))*$`
- *VISA 信用卡号*: `^(4[0-9]{12}(?:[0-9]{3})?)*$`
- *日期 (MM/DD/YYYY)*: `^(0?[1-9]|1[012])[- /.](0?[1-9]|[12][0-9]|3[01])[- /.](19|20)?[0-9]{2}$`
- *日期 (YYYY/MM/DD)*: `^(19|20)?[0-9]{2}[- /.](0?[1-9]|1[012])[- /.](0?[1-9]|[12][0-9]|3[01])$`
- *MasterCard 信用卡号*: `^(5[1-5][0-9]{14})*$`